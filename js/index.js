var rating = "https://raw.githubusercontent.com/asozialesnetzwerk/zitate/master/bewertung_zitate.json"
var authors = "https://raw.githubusercontent.com/asozialesnetzwerk/zitate/master/namen.txt"
var quotes = "https://raw.githubusercontent.com/asozialesnetzwerk/zitate/master/zitate.txt"

window.q = [];
window.r = [];

var getQuote = function(data) {
    q.push(data.split(/\n/));
    if(window.q.length==2 && window.r.length==1) createZitat();
};
var getRating = function(data) {
    r.push(JSON.parse(data));
};

$.get(rating, getRating, 'text');
$.get(authors, getQuote, 'text');
$.get(quotes, getQuote, 'text');

$(".get-quote").on("click", function() {
    createZitat();
});

function createZitat()
{
    while (window.r[0][z] === undefined || window.r[0][z] <= 0 ) { //Bis positive Zitate gefunden
        var a=Math.floor(Math.random() * window.q[0].length);
        var q=Math.floor(Math.random() * window.q[1].length);
        var z=q+"-"+a; //Zitat-ID
    }
        var theAuthor = window.q[0][a];
        var theQuote = window.q[1][q];
        $(".quote-text").text(theQuote);
        $(".quote-author").text("- " + theAuthor);
        $(".quote-id").text(z);
        $(".quote-rating").text("Rating: "+window.r[0][z]);

        $(".tweet").attr("href", "https://twitter.com/intent/tweet?text=" + encodeURIComponent(theQuote + ' - ' + theAuthor + "\nID: "+z+" Generated by https://asozialesnetzwerk.github.io/zitate"));
}
